YUI.add("moodle-tinymce_mathslate-snippeteditor",function(s,t){M.tinymce_mathslate=M.tinymce_mathslate||{},(M&&M.tinymce_mathslate||{}).mSlots=function(){var i,o=[],r=0,e=[];function n(){var t,n;o.splice(r),t=e.slice(0),n=[],t.forEach(function(t){n.push(t.slice(0))}),o[r]=[t,n]}function t(){var t,i;e.splice(0),e[0]&&e.pop(),t=o[r][0],i=o[r][1],t.forEach(function(n,t){n.splice(0),n[0]&&n.pop(),i[t].forEach(function(t){n.push(t)}),e.push(n)})}this.slots=e,this.redo=function(){return o[r+1]?(r++,t(),this):this.next||this},this.undo=function(){return 0===r?this.previous||this:(0===--r?e[0].pop():t(),this)},this.createItem=function(t){var n,i;return n="MJX-"+s.Node.create("<span></span").generateID(),(i=s.JSON.parse(t))[1].id=n,function o(i){Array.isArray(i[2])&&i[2].forEach(function(t){if(Array.isArray(t))o(t);else if("[]"===t){var n="MJX-"+s.guid();e.push([["mo",{id:n,"class":"blank",tex:[""]},"◻"]]),i[2][i[2].indexOf(t)]=["mrow",{},e[e.length-1]]}})}(i),i},this.getItemByID=function(n){var i;return this.slots.forEach(function(t){t.forEach(function(t){t[1].id===n&&(i=s.JSON.stringify(t))})}),i},this.isItem=function(n){var i=!1;return this.slots.forEach(function(t){i||t.forEach(function(t){t[1].id===n&&(i=!0)})}),i},this.removeSnippet=function(i){var o=0;return this.slots.forEach(function(n){n.forEach(function(t){t[1].id===i&&(o=t,n.splice(n.indexOf(t),1))})}),o},this.insertSnippet=function(i,o){var s=0;this.slots.forEach(function(n){n.forEach(function(t){0===s&&t[1].id===i&&(s=t,n.splice(n.indexOf(s),0,o))})}),r++,this.next=null,n()},this.append=function(t){e[0].push(t),r++,this.next=null,n()},this.forEach=function(i){this.slots.forEach(function(n){n.forEach(function(t){i(t,n)})})},this.rekey=function(){var i=this;this.slots.forEach(function(n){0===n.length?n.push(["mo",{id:"MJX-"+s.guid(),"class":"blank",tex:[""]},"◻"]):n.forEach(function(t){t[1]&&(t[1]["class"]&&"blank"===t[1]["class"]&&1<n.length&&i.removeSnippet(t[1].id),t[1].id&&(t[1].id="MJX-"+s.guid()))})})},this.output=function(s){var n="";return e[0].forEach(function(t){n+=function o(t){var n,i="";if("string"==typeof t)return t;if(t[1]&&t[1][s])for(n=0;t[1][s][n];)i+=t[1][s][n++],t[2]&&"number"==typeof t[1][s][n]&&(i+=o(t[2][t[1][s][n]])),n++;else t[2]&&("string"==typeof t[2]?i+=t[2]:t[2].forEach(function(t){i+=o(t)}));return i}(t)}),n},this.preview=function(s){var n="";return e[0].forEach(function(t){n+=function o(t){var n,i="";if("string"==typeof t)return t;if(t[1]&&t[1].id&&(i=i+'<div id="'+t[1].id+'">'),t[1]&&s&&t[1][s])for(n=0;t[1][s][n];)i+=t[1][s][n++],t[2]&&"number"==typeof t[1][s][n]&&(i+=o(t[2][t[1][s][n]])),n++;else t[2]&&("string"==typeof t[2]?s&&(i+=t[2]):t[2].forEach(function(t){i+=o(t)}));return t[1]&&t[1]["class"]&&"blank"===t[1]["class"]&&(i+="<br>"),t[1]&&t[1].id&&(i+="</div>"),i}(t)}),n},this.select=function(n){i=null,this.slots.forEach(function(t){t.forEach(function(t){t[1].id===n&&(i=t)})})},this.getSelected=function(){return i&&i[1].id}}},"@VERSION@",{requires:["json"]});